<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home_Person</title>
    <link href="../../css/Home_Part/Home_Person.css" rel="stylesheet">
    <script src="../../js/jquery-3.4.1.min.js"></script>
    <script src="../../js/jquery.form.js"></script>
    <script>
        $(function () {
            function getCookie(cname) {
                var name = cname + "=";
                var decodedCookie = decodeURIComponent(document.cookie);
                var ca = decodedCookie.split(';');
                for(var i = 0; i < ca.length; i++) {
                    var c = ca[i];
                    while (c.charAt(0) == ' ') {
                        c = c.substring(1);
                    }
                    if (c.indexOf(name) == 0) {
                        return c.substring(name.length, c.length);
                    }
                }
                return "";
            }
            // var username=getCookie("cookie_username");
            var account=getCookie("cookie_account");


            var formdata=new FormData();
            //点击“点击更换头像”按钮
            $("#change_logo1_click").click(function () {
                $("#change_logo1").css("display","none");
                $("#change_logo2").css("display","inline");
            })
            //点击 “取消” 按钮
            $("#cancel_change").click(function () {
                $("#change_logo2").css("display","none");
                $("#change_logo1").css("display","inline");

            })
            //点击 “修改密码” 按钮
            $("input[name='change_password']").click(function () {
                alert("it click it")
                $("#pass_button").css("display","none");
                $(".change_pass").css("display","inline");

            })
            //点击 “确定更换”
            $("#form1").ajaxForm(function (data) {
                alert("进入提交");
                alert(data);
                $("#user_logo_img").attr("src",data);
                alert("文件提交已成功！")
            })

            //点击取消修改
            $("#delete_update").click(function () {
                window.location.reload();
            })
            //点击 “保存修改” 按钮
            $("#save_update").click(function () {
                alert(account),
                formdata.append("account",account),
                formdata.append("file",$("#new_head")[0].files[0]),
                formdata.append("name",$("#name").val()),
                formdata.append("sex",$("#sex_type").val()),
                formdata.append("birthday",$("#birthdaydate").val()),
                formdata.append("fondness",$("#fondness").val()),
                formdata.append("signature",$("#signature").val()),
                formdata.append("phone",$("#phonenumber").val()),
                formdata.append("password",$("#passwordnumber").val())
                $.ajax({
                        url:"http://127.0.0.1:8090/userinfo/updUserInfo",
                            type:"post",
                            dataType:"json",
                            data:formdata,
                            contentType: false,
                            processData: false,
                        success:function (data) {
                            if(data==1)
                                window.location.href="http://127.0.0.1:8090/html/home.html";
                            alert("成功了")
                        },error:function (data) {
                            alert("失败了")
                        }
                    })
                // $.ajax({
                //     url:"http://127.0.0.1:8090/userinfo/updUserInfo",
                //     type:"post",
                //     dataType:"json",
                //     data:{
                //         file:$("#new_head").files[0],
                //         name:$("#name").val(),
                //         sex:$("#sex_type").val(),
                //         birthday:$("#birthdaydate").val(),
                //         fondness:$("#fondness").val(),
                //         signature:$("#signature"),
                //         phone:$("#phonenumber").val(),
                //         password:$("#passwordnumber"),
                //     }
                //     ,success:function (data) {
                //         alert("成功")
                //     },error:function (data) {
                //         alert("失败")
                //     }
                // })


            })


            // $("#save_update").click(function () {
            //     alert("保存修改")
            //     var form=$("#form1");
            //     var filepart=new FormData(form);
            //     alert(filepart);
            //
            //     $.ajax({
            //         url: "http://localhost:8080/userinfo/updateInfo",
            //         type: "post",
            //         dataType:"json",
            //         data: form,
            //         async: false,
            //         cache: false,
            //         contentType: false,
            //         processData: false,
            //         // filepart: $("#new_head").val()
            //         success: function (data) {
            //             alert("success")
            //         },
            //         error: function (data) {
            //             alert(data)
            //             alert("error")
            //         }
            //     })
            // })
        })
    </script>
</head>

<body>
<!--左侧好友列表-->
<div id="letf_part">
    <div id="overview">
        <li><div>说说： </div><p>****</p></li>
        <li><div>留言： </div><p>****</p></li>
        <li><div>相册： </div><p>****</p></li>
    </div>

</div>
<!--      中间的好友动态部分-->
<div id="center_part"></div>
<!--右侧的搜索-->
<div id="right_part">
    <div id="info">
<!--        <form id="form1">-->
       <div id="user_logo"><img id="user_logo_img" src="../../images/登录背景1.jpg"/></div>
<!--        <div id="user_logo"><img id="user_logo_img" src="D:\temp-rainy\df595008-5cae-448a-a2cb-c42719f623f7.jpg"/></div>-->
        <!--      修改头像替换模块1-->
        <div id="change_logo1" style="display: inline">
            <button id="change_logo1_click">点击更换头像</button>
        </div>
        <!--      修改头像替换模块2-->
        <div id="change_logo2" style="display: none">
         <form action="/userinfo/updateInfo" method="post" enctype="multipart/form-data" id="form1">
              <input id="new_head" name="file" type="file">
                <input id="cancel_change" type="button" value="取消">
                <input id="sure_change" type="submit" value="确定更换">
         </form>
        </div>
        <div id="user_name" >
            <p>昵称：</p><input type="text" id="name" >
        </div>

        <li><div class="model"><div id="sex" >性别：</div><div class="write"><input type="text" id="sex_type" ></div></div></li>
        <li><div class="model"><div id="birthday">出生年月日：</div><div class="write"><input type="date" id="birthdaydate" ></div></div></li>
<!--  先不做星座的，从简单的做
     <li><div class="model"><div id="constellation">星座：</div><div class="write"><input type="text" name="constellation" ></div></div></li>-->
        <li><div class="model"><div id="like">爱好：</div><div class="write"><input type="text" id="fondness"></div></div></li>
        <li><div class="model"><div id="sign">个性签名：</div><div class="write"><input type="text" id="signature" ></div></div></li>

        <li id="pass_button"><div class="model"><div class="write" id="change_password"><input  name="change_password" type="button" value="修改密码"></input></div></div></li>

        <li class="change_pass" style="display: none"><div class="model"><div id="password_change1">密码：</div><div class="write"><input type="password" name="password_change1" id="passwordnumber"></div></div></li>
        <li class="change_pass" style="display: none"><div class="model"><div id="password_change2">确认新密码：</div><div class="write"><input type="password" name="password_change2"></div></div></li>

        <li><div class="model"><div id="phone">电话号码：</div><div class="write"><input type="text" id="phonenumber"></div></div></li>


        <div id="info_bottom">
        <input id="delete_update" type="button" value="取消修改">
        <input id="save_update" type="button" value="保存修改">
    </div>
    </div>
</div>
</body>
<!--<iframe  id="submitFrame" style="display: none;width:0; height:0" name="submitFrame"  src="about:blank"></iframe>-->
</html>